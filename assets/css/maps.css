/* Definición de Variables CSS Globales */
:root {
    --primary-color: #0073aa;
    --primary-color-hover: #005177;
    --secondary-button-bg: #e5e5e5;
    --secondary-button-hover-bg: #d5d5d5;
    --secondary-button-focus-border: #b0b0b0; /* For focus on secondary button */
    --text-color-light: #fff;
    --text-color-dark: #333;
    --text-color-medium: #555;
    --text-color-error: #ff0000; /* Standard red for errors */
    --border-color-standard: #ccc;
    --border-color-light: #ddd; /* Lighter border for internal table cells */
    --border-color-focus: var(--primary-color); /* Use primary color for focus border */
    --border-radius-standard: 4px;
    --border-radius-large: 8px; /* For larger containers */

    --background-color-light: #fff;
    --background-color-medium: #f9f9f9; /* For alternate rows or panels */
    --background-color-dark: #e9e9e9; /* For info sections or disabled states */
    --background-color-thead: #f0f0f0; /* Table header background */
    --background-color-overlay: rgba(0, 0, 0, 0.6); /* Modal overlay */
    --background-color-loading: #eee; /* For loading spinner on buttons */

    --padding-small: 5px;
    --padding-standard: 10px;
    --padding-medium: 12px; /* Specific for submit button */
    --padding-large: 15px;
    --padding-xlarge: 20px;

    --margin-small: 5px;
    --margin-standard: 10px;
    --margin-medium: 15px;
    --margin-large: 20px;
    --margin-xlarge: 30px; /* For major section spacing */

    --font-size-small: 0.8em;
    --font-size-standard: 1em;
    --font-size-medium: 1.2em; /* For submit button */
    --font-size-large: 1.6em; /* Modal title */
    --font-size-xlarge: 1.8em; /* Panel h2 */
    --font-size-xxlarge: 2em; /* Main panel title */

    --shadow-standard: 0 4px 8px rgba(0, 0, 0, 0.1);
    --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.08);
    --shadow-medium: 0 2px 4px rgba(0,0,0,0.05); /* For client requests panel */
    --shadow-modal: 0 5px 15px rgba(0,0,0,0.3);
    --focus-outline: 2px solid var(--primary-color);
    --focus-outline-offset: 2px;
    --focus-shadow-color: rgba(0, 115, 170, 0.3); /* Kept for form-control, can be unified */

    /* Feedback Message Colors */
    --feedback-success-bg: #d4edda;
    --feedback-success-border: #c3e6cb;
    --feedback-success-text: #155724;
    --feedback-error-bg: #f8d7da;
    --feedback-error-border: #f5c6cb;
    --feedback-error-text: #721c24;
    --feedback-info-bg: #d1ecf1;
    --feedback-info-border: #bee5eb;
    --feedback-info-text: #0c5460;

    /* Status Badge Colors (Updated based on request) */
    --status-pending-bg: #ffebcc;
    --status-pending-text: #996515;
    --status-pending-border: #f0ad4e;

    --status-accepted-bg: #cfe2ff;
    --status-accepted-text: #0a58ca;
    --status-accepted-border: #0d6efd;

    --status-on_the_way-bg: #d1e7dd;
    --status-on_the_way-text: #0f5132;
    --status-on_the_way-border: #198754;

    --status-arrived-bg: #e0f7fa;
    --status-arrived-text: #00796b;
    --status-arrived-border: #00bcd4;

    --status-picked_up-bg: #d1e7dd; /* Same as on_the_way for active travel */
    --status-picked_up-text: #0f5132;
    --status-picked_up-border: #198754;

    --status-completed-bg: #e9ecef;
    --status-completed-text: #495057;
    --status-completed-border: #adb5bd;

    --status-rejected-bg: #f8d7da;
    --status-rejected-text: #721c24;
    --status-rejected-border: #dc3545;

    --status-default-bg: #f0f0f0;
    --status-default-text: #333;
    --status-default-border: #ccc;
}

/* Feedback Messages (Standardized) */
.cachilupi-feedback {
    padding: var(--padding-standard, 10px);
    margin-top: var(--margin-large, 20px); /* Or margin-bottom if placed below an element */
    margin-bottom: var(--margin-large, 20px);
    border: 1px solid transparent;
    border-radius: var(--border-radius-standard, 4px);
    text-align: center;
}

.cachilupi-feedback--success {
    background-color: var(--feedback-success-bg, #d4edda);
    border-color: var(--feedback-success-border, #c3e6cb);
    color: var(--feedback-success-text, #155724);
}

.cachilupi-feedback--error {
    background-color: var(--feedback-error-bg, #f8d7da);
    border-color: var(--feedback-error-border, #f5c6cb);
    color: var(--feedback-error-text, #721c24);
}

.cachilupi-feedback--info {
    background-color: var(--feedback-info-bg, #d1ecf1);
    border-color: var(--feedback-info-border, #bee5eb);
    color: var(--feedback-info-text, #0c5460);
}


/* Estilos Generales del Contenedor de Reserva y Mapa */
.cachilupi-booking-container {
    display: flex;
    flex-wrap: wrap;
    gap: var(--margin-xlarge, 30px);
    max-width: 1200px; /* Consider if this should be a variable */
    margin: var(--margin-large, 20px) auto;
    padding: var(--padding-xlarge, 20px);
    background-color: var(--background-color-light, #fff);
    box-shadow: var(--shadow-standard, 0 4px 8px rgba(0, 0, 0, 0.1));
    border-radius: var(--border-radius-large, 8px);
}

/* Panel de Reserva (Formulario) */
.cachilupi-booking-panel {
    font-family: 'Arial', sans-serif;
    flex: 1 1 450px;
}

.cachilupi-booking-form h1 { /* Targeting h1 inside the form specifically */
    text-align: center;
    color: var(--text-color-dark, #333);
    margin-bottom: var(--margin-xlarge, 30px);
    font-size: var(--font-size-xxlarge, 2em);
}


/* Sección dentro del formulario */
.form-section {
    background-color: var(--background-color-light, #fff);
    padding: var(--padding-xlarge, 20px);
    border-radius: var(--border-radius-standard, 6px);
    margin-bottom: var(--margin-large, 20px);
    box-shadow: var(--shadow-light, 0 1px 3px rgba(0, 0, 0, 0.08));
}

/* Grupo de Formulario */
.form-group {
    margin-bottom: var(--margin-large, 20px);
}

.form-group label {
    display: block;
    margin-bottom: var(--margin-small, 8px); /* Adjusted from 8px to variable */
    font-weight: bold;
    color: var(--text-color-medium, #555);
}

/* Control de Formulario (Inputs, Selects, Textareas) */
.form-control {
    width: 100%;
    padding: var(--padding-standard, 10px);
    border: 1px solid var(--border-color-standard, #ccc);
    border-radius: var(--border-radius-standard, 4px);
    box-sizing: border-box;
    font-size: var(--font-size-standard, 1em);
}

.form-control:focus {
    border-color: var(--border-color-focus, var(--primary-color, #0073aa));
    box-shadow: 0 0 5px var(--focus-shadow-color, rgba(0, 115, 170, 0.3));
    outline: none;
}

/* Contenedor del Geocoder */
.geocoder-container {
    margin-bottom: var(--padding-standard, 10px);
}

/* Botones Generales del Formulario */
.button {
    display: inline-block;
    padding: var(--padding-standard, 10px) var(--padding-large, 20px); /* Adjusted for consistency */
    font-size: var(--font-size-standard, 1em);
    cursor: pointer;
    border: none;
    border-radius: var(--border-radius-standard, 4px);
    text-align: center;
    text-decoration: none;
    transition: background-color 0.3s ease;
}
.button:focus {
    outline: var(--focus-outline);
    outline-offset: var(--focus-outline-offset);
    box-shadow: 0 0 0 var(--focus-outline-offset) var(--focus-shadow-color); /* Alternative focus */
}

.button:disabled,
.button.cachilupi-button--loading { /* Standardized loading/disabled class */
    opacity: 0.7;
    cursor: not-allowed;
    pointer-events: none;
}

.button.cachilupi-button--loading { /* Specific to loading if different from general disabled */
}

.button.cachilupi-button--loading::after {
    content: ' ...';
    display: inline-block;
    margin-left: var(--margin-small, 5px);
}


/* Botón Primario */
.button-primary {
    background-color: var(--primary-color, #0073aa);
    color: var(--text-color-light, white);
}

.button-primary:hover,
.button-primary:focus {
    background-color: var(--primary-color-hover, #005177);
}

/* Botón Secundario */
.button-secondary {
    background-color: var(--secondary-button-bg, #e5e5e5);
    color: var(--text-color-dark, #333);
    margin-left: var(--margin-standard, 10px);
}

.button-secondary:hover,
.button-secondary:focus {
    background-color: var(--secondary-button-hover-bg, #d5d5d5);
}
.button-secondary:focus { /* More specific focus for secondary if needed */
    border-color: var(--secondary-button-focus-border, #b0b0b0); /* Example, if it had a border */
    box-shadow: 0 0 5px rgba(150, 150, 150, 0.5); /* Example shadow */
}


/* Botón de Envío Específico */
#submit-service-request.button-primary { /* More specific selector for the submit button */
    display: block;
    width: 100%;
    margin-top: var(--margin-large, 20px);
    padding: var(--padding-medium, 12px); /* Specific padding */
    font-size: var(--font-size-medium, 1.2em); /* Specific font size */
}

/* Información de Distancia */
.distance-display { /* Renamed from .distance-info to match HTML */
    margin-top: var(--margin-medium, 15px);
    padding: var(--padding-standard, 10px);
    background-color: var(--background-color-dark, #e9e9e9);
    border-left: 4px solid var(--primary-color, #0073aa);
    margin-bottom: var(--margin-large, 20px);
    font-size: 0.95em;
    color: var(--text-color-medium);
}
.distance-display.loading {
    font-style: italic;
}


/* Indicador de campo requerido */
.required-field-indicator {
    color: var(--text-color-error, red);
    margin-left: var(--margin-small, 5px);
}
.form-group label.required-field-label::after {
    content: " *";
    color: var(--text-color-error, red);
    font-weight: normal;
}

/* Estilos del Mapa en la página de reserva */
#cachilupi-pet-map {
    flex: 1 1 550px;
    width: 100%;
    height: 500px;
    border-radius: var(--border-radius-standard, 6px);
    overflow: hidden;
}

/* Media Queries para el layout responsivo del contenedor de reserva y mapa */
@media (max-width: 768px) {
    .cachilupi-booking-container {
        flex-direction: column;
        gap: var(--margin-medium, 15px);
        padding: var(--padding-large, 15px);
    }
    .cachilupi-booking-form { /* Target the form container */
        order: 1;
        flex-basis: auto;
        margin-bottom: 0;
    }
    #cachilupi-pet-map {
        height: 350px;
        order: 2;
        margin-top: 0;
    }
    .form-section {
        padding: var(--padding-large, 15px);
    }
}

/* Estilos para Mapbox Geocoder */
.mapboxgl-ctrl-geocoder {
    width: 100%;
    margin-bottom: var(--margin-standard, 10px);
    max-width: none !important;
}

.mapboxgl-ctrl-geocoder .suggestions { position: absolute; z-index: 2000; } /* Added z-index */

.mapboxgl-ctrl-geocoder--results {
    position: absolute;
    z-index: 2000;
    width: 100%;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Consider var(--shadow-light) or similar */
}

.mapboxgl-ctrl-geocoder ul {
    width: 100%;
}

/* Styling for Mapbox Geocoder input field */
.mapboxgl-ctrl-geocoder--input {
    width: 100% !important;
    height: auto !important;
    padding: var(--padding-standard, 10px) 35px var(--padding-standard, 10px) var(--padding-standard, 10px) !important;
    margin-bottom: 0 !important;
    box-sizing: border-box !important;
    border: 1px solid var(--border-color-standard, #ccc) !important;
    border-radius: var(--border-radius-standard, 4px) !important;
    font-size: var(--font-size-standard, 1em); /* Corrected to use standard or a specific var */
    line-height: 1.5;
    color: var(--text-color-dark, #333);
    background-color: var(--background-color-light, #fff);
    background-clip: padding-box;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}
.mapboxgl-ctrl-geocoder--input:focus {
    border-color: var(--border-color-focus, var(--primary-color, #0073aa)) !important;
    box-shadow: 0 0 5px var(--focus-shadow-color, rgba(0, 115, 170, 0.3)) !important;
    outline: none !important;
}


/* Styling for Mapbox Geocoder search icon */
.mapboxgl-ctrl-geocoder--icon {
    top: 50% !important;
    transform: translateY(-50%) !important;
    left: auto !important;
    right: var(--padding-standard, 10px) !important;
    color: var(--text-color-medium, #555) !important;
}

/* Etiquetas para los campos de geocodificador - Not needed as they are part of .form-group label */

/* Estilos para mensajes de error (field specific validation messages) */
.error-message {
    color: var(--text-color-error, red); /* This is fine, uses a variable */
    font-size: var(--font-size-small, 0.8em);
    display: block;
    margin-top: var(--margin-small, 5px);
}


/* === Estilos para la tabla de solicitudes del cliente === */
.cachilupi-client-requests-panel {
    flex-basis: 100%; /* Ocupa todo el ancho si el contenedor es flex */
    margin-top: var(--margin-xlarge, 30px);
    padding: var(--padding-xlarge, 20px);
    background-color: var(--background-color-light, #fff); /* Fondo más claro */
    border-radius: var(--border-radius-large, 8px);
    box-shadow: var(--shadow-medium, 0 2px 4px rgba(0,0,0,0.05));
}

.cachilupi-client-requests-panel h2 {
    font-size: var(--font-size-xlarge, 1.8em);
    margin-bottom: var(--margin-large, 20px);
    color: var(--text-color-dark, #333);
    text-align: left; /* Alineación a la izquierda para el título */
}

.cachilupi-client-requests-panel table.widefat {
    width: 100%;
    border-collapse: collapse;
    margin-top: var(--margin-standard, 10px); /* Espacio sobre la tabla */
}

.cachilupi-client-requests-panel table.widefat th,
.cachilupi-client-requests-panel table.widefat td {
    padding: var(--padding-medium, 12px) var(--padding-large, 15px); /* Más padding */
    text-align: left;
    border-bottom: 1px solid var(--border-color-light, #ddd); /* Borde sutil entre filas */
}

.cachilupi-client-requests-panel table.widefat th {
    background-color: var(--background-color-thead, #f0f0f0);
    font-weight: 600; /* Texto más bold para cabeceras */
    color: var(--text-color-dark, #333);
    text-transform: uppercase;
    font-size: 0.9em; /* Ligeramente más pequeño */
    letter-spacing: 0.5px;
}
.cachilupi-client-requests-panel table.widefat tbody tr:hover {
    background-color: var(--background-color-medium, #f9f9f9); /* Hover sutil */
}


/* Estilos para los badges de estado */
.cachilupi-client-requests-panel .request-status span { /* Target the span inside */
    font-weight: bold;
    padding: 5px 10px; /* Adjusted from example */
    border-radius: 15px; /* Pill shape from example */
    text-align: center;
    display: inline-block;
    min-width: 110px; /* Ancho mínimo para consistencia */
    font-size: 0.85em; /* Adjusted from example */
    line-height: 1.4;
    text-transform: uppercase; /* From example */
    border-width: 1px; /* Adding border width */
    border-style: solid; /* Adding border style */
}

.cachilupi-client-requests-panel .request-status-pending span {
    background-color: var(--status-pending-bg);
    color: var(--status-pending-text);
    border-color: var(--status-pending-border);
}
.cachilupi-client-requests-panel .request-status-accepted span {
    background-color: var(--status-accepted-bg);
    color: var(--status-accepted-text);
    border-color: var(--status-accepted-border);
}
.cachilupi-client-requests-panel .request-status-on_the_way span,
.cachilupi-client-requests-panel .request-status-picked_up span { /* Grouped picked_up with on_the_way */
    background-color: var(--status-on_the_way-bg);
    color: var(--status-on_the_way-text);
    border-color: var(--status-on_the_way-border);
}
.cachilupi-client-requests-panel .request-status-arrived span {
    background-color: var(--status-arrived-bg);
    color: var(--status-arrived-text);
    border-color: var(--status-arrived-border);
}
.cachilupi-client-requests-panel .request-status-completed span {
    background-color: var(--status-completed-bg);
    color: var(--status-completed-text);
    border-color: var(--status-completed-border);
}
.cachilupi-client-requests-panel .request-status-rejected span {
    background-color: var(--status-rejected-bg);
    color: var(--status-rejected-text);
    border-color: var(--status-rejected-border);
}
/* Fallback for any other status not explicitly defined */
.cachilupi-client-requests-panel .request-status span:not([class*='request-status-']) {
    background-color: var(--status-default-bg);
    color: var(--status-default-text);
    border-color: var(--status-default-border);
}


/* Botón de seguimiento */
.cachilupi-client-requests-panel .cachilupi-follow-driver-btn {
    padding: 6px 12px; /* From example */
    font-size: 0.9em; /* From example */
    cursor: pointer;
    background-color: var(--primary-color); /* WordPress blue from example */
    border-color: var(--primary-color-hover); /* Darker shade for border */
    color: var(--text-color-light);
    border-radius: var(--border-radius-standard);
    text-decoration: none;
    transition: background-color 0.3s ease;
    border-style: solid;
    border-width: 1px;
}
.cachilupi-client-requests-panel .cachilupi-follow-driver-btn:hover,
.cachilupi-client-requests-panel .cachilupi-follow-driver-btn:focus {
    background-color: var(--primary-color-hover); /* From example */
}


/* Modal de seguimiento del conductor para el cliente */
#cachilupi-follow-modal {
    display: none; /* Hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--background-color-overlay, rgba(0, 0, 0, 0.6));
    z-index: 10000; /* Ensure it's on top */
    display: flex; /* Use flex to center content */
    align-items: center;
    justify-content: center;
}

/* Contenido del modal de seguimiento */
#cachilupi-follow-modal > div { /* Direct child which is the modal content */
    width: 90%;
    max-width: 700px;
    max-height: 85vh; /* Max height */
    background-color: var(--background-color-light, white);
    padding: var(--padding-xlarge, 20px);
    border-radius: var(--border-radius-large, 8px);
    box-shadow: var(--shadow-modal, 0 5px 15px rgba(0,0,0,0.3));
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Prevent map from overflowing rounded corners initially */
}

#cachilupi-follow-modal-title {
    margin-top: 0;
    margin-bottom: var(--margin-medium, 15px);
    font-size: var(--font-size-large, 1.6em);
    color: var(--text-color-dark, #333);
    text-align: center;
}

#cachilupi-client-follow-map {
    width: 100%;
    height: 60vh; /* Responsive height */
    min-height: 300px; /* Minimum height */
    margin-bottom: var(--margin-medium, 15px);
    border: 1px solid var(--border-color-standard, #ccc);
    border-radius: var(--border-radius-standard, 4px);
}

#cachilupi-close-follow-modal {
    padding: var(--padding-standard, 10px) var(--padding-large, 15px);
    background-color: var(--secondary-button-bg, #e0e0e0);
    color: var(--text-color-dark, #333);
    border: none;
    border-radius: var(--border-radius-standard, 4px);
    cursor: pointer;
    align-self: center; /* Center button */
    margin-top: var(--margin-standard, 10px);
    transition: background-color 0.2s ease;
}

#cachilupi-close-follow-modal:hover,
#cachilupi-close-follow-modal:focus {
    background-color: var(--secondary-button-hover-bg, #d0d0d0);
}

/* Estilos responsivos para la tabla de solicitudes del cliente */
@media (max-width: 768px) {
    .cachilupi-client-requests-panel table.widefat thead {
        display: none;
    }

    .cachilupi-client-requests-panel table.widefat tr {
        display: block;
        margin-bottom: var(--margin-medium, 15px);
        border: 1px solid var(--border-color-light, #ddd);
        padding: var(--padding-standard, 10px);
        border-radius: var(--border-radius-standard, 5px); /* Softer radius for cards */
        background-color: var(--background-color-light, #fff); /* Ensure cards have background */
    }

    .cachilupi-client-requests-panel table.widefat td {
        display: block;
        text-align: right;
        padding-left: 50%; /* Create space for the label */
        position: relative;
        border-bottom: 1px solid var(--border-color-light, #eee); /* Light separator inside card */
        padding-top: var(--padding-standard, 10px);
        padding-bottom: var(--padding-standard, 10px);
    }
    .cachilupi-client-requests-panel table.widefat td:last-child {
        border-bottom: none;
    }

    .cachilupi-client-requests-panel table.widefat td::before {
        content: attr(data-label);
        position: absolute;
        left: var(--padding-standard, 10px); /* Align with cell padding */
        top: 50%;
        transform: translateY(-50%);
        width: calc(50% - 2*var(--padding-standard, 10px)); /* Adjust width based on padding */
        padding-right: var(--padding-standard, 10px);
        white-space: nowrap;
        text-align: left;
        font-weight: bold;
        color: var(--text-color-dark, #333);
    }

    /* Specific adjustments for status and buttons in card view */
    .cachilupi-client-requests-panel table.widefat td.request-status {
        text-align: right; /* Align the badge itself to the right if text-align on td is right */
    }
     .cachilupi-client-requests-panel table.widefat td.request-status span {
        /* The span is already inline-block, so it will respect text-align of parent td */
         margin-top: 0; /* Reset any top margin if needed */
         /* From example: Ensure it fits well in the data-label layout */
        display: inline; /* Might be better than inline-block for flow with data-label */
        padding: 3px 6px;
        font-size: 0.8em;
        min-width: auto;
    }
    .cachilupi-client-requests-panel table.widefat td[data-label="Seguimiento:"] .button {
        display: inline-block; /* Allow button to sit naturally with text-align:right */
        width: auto;
    }
}

@media (max-width: 480px) {
    .cachilupi-client-requests-panel table.widefat td {
        padding-left: var(--padding-standard, 10px); /* Remove 50% padding */
        text-align: left; /* Align content to left */
    }
    .cachilupi-client-requests-panel table.widefat td::before {
        position: static; /* Let label flow naturally */
        display: block;
        width: auto;
        transform: none; /* Reset transform */
        margin-bottom: var(--margin-small, 5px);
        font-size: 0.85em; /* Smaller label */
        color: var(--text-color-medium);
    }
    .cachilupi-client-requests-panel table.widefat td.request-status {
        text-align: left;
    }
    .cachilupi-client-requests-panel table.widefat td.request-status span {
        /* From example: Make status take its own line under the label */
        display: block;
        width: fit-content; /* Adjust width */
        /* margin-left: auto; If text-align: right on td */
        /* margin-right: auto; If text-align: center on td */
    }

    .cachilupi-client-requests-panel table.widefat td[data-label="Seguimiento:"] .button {
        width: 100%; /* Make button full width for easier tapping */
        margin-top: var(--margin-small, 5px);
    }
}
